{% extends "base.html" %}

{% block title %} Profile {% endblock %}

{% block content %}
<h1>Profile Page</h1>
<p>Welcome, {{ user.first_name }}!</p>
<p>Email: {{ user.email }}</p>

{% if user.is_admin %}
    <p><a href="{{ url_for('admin.index') }}">Go to Admin Panel</a></p>
{% endif %}

<form action="{{ url_for('views.delete_profile') }}" method="post" onsubmit="return confirm('Are you sure you want to delete your profile? This action cannot be undone.');">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
    <button type="submit">Delete My Profile</button>
</form>

<!-- Form for adding a new note -->
<form method="POST" action="{{ url_for('auth.profile') }}">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>  <!-- Include CSRF token -->
    <label for="note">Add a new note:</label>
    <textarea id="note" name="note" rows="4" cols="50"></textarea><br>
    <label for="is_public">
        <input type="checkbox" id="is_public" name="is_public"> Make this note public
    </label><br>
    <button type="submit">Add Note</button>
</form>

<h2>Your Notes:</h2>
<ul>
    {% if user.notes %}
        {% for note in user.notes %}
            <li>{{ note.data }} (User ID: {{ user.first_name }})
                <form action="{{ url_for('views.delete_note', note_id=note.id) }}" method="post">
                    
                    <input type="hidden" name="note_id" value="{{ note.id }}">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                    <button type="submit">Delete Note</button>
                </form>
            </li>
        {% endfor %}
    {% else %}
        <li>No notes found.</li>
    {% endif %}
</ul>


{% endblock %}
